---
# Install VSCode (Application Layer - Flatpak) and extensions

- name: Install Visual Studio Code via Flatpak
  become: yes
  community.general.flatpak:
    name: com.visualstudio.code
    state: present

- name: Install VSCode extensions
  command: flatpak run com.visualstudio.code --install-extension {{ item }}
  loop: "{{ vscode_extensions }}"
  register: vscode_ext_result
  changed_when: "'successfully installed' in vscode_ext_result.stdout"
  failed_when: false

- name: Create VSCode settings directory
  file:
    path: "{{ ansible_env.HOME }}/.var/app/com.visualstudio.code/config/Code/User"
    state: directory
    mode: '0755'

# Note: Add VSCode settings.json and keybindings.json to tasks/vscode/config/ if needed
# Flatpak VSCode config location: ~/.var/app/com.visualstudio.code/config/Code/User
